# AI Agent ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## é¡¹ç›®ç›®æ ‡

æ„å»ºä¸€ä¸ª **Agentic AI** ç³»ç»Ÿï¼Œè®© AI èƒ½å¤Ÿè‡ªä¸»å®Œæˆè½¯ä»¶å·¥ç¨‹çš„å®Œæ•´æµç¨‹ï¼š

```
éœ€æ±‚åˆ†æ â†’ è®¾è®¡ â†’ å¼€å‘ â†’ æµ‹è¯• â†’ éªŒæ”¶ â†’ ä¸Šçº¿
```

**æ ¸å¿ƒç†å¿µ**ï¼š
- ç»™ AI ä¸€ä¸ªç›®æ ‡å’Œä¸Šä¸‹æ–‡ï¼ŒAI è‡ªä¸»æ‰§è¡Œå¤šä¸ªæ­¥éª¤å®Œæˆä»»åŠ¡
- é‡åˆ°é—®é¢˜èƒ½è‡ªå·±è§£å†³æˆ–è¯¢é—®äººç±»
- æ‰§è¡Œç»“æœè‡ªåŠ¨éªŒè¯ï¼Œå¤±è´¥è‡ªåŠ¨é‡è¯•
- å…ˆåšå‚ç›´ä¸šåŠ¡é¢†åŸŸï¼Œå†è€ƒè™‘é€šç”¨åŒ–

## æ¼”è¿›è·¯çº¿

### Phase 1: åŸºç¡€å¯¹è¯ âœ… å·²å®Œæˆ
- ä»»åŠ¡å…³è” AI ä¼šè¯
- å¤šè½®å¯¹è¯æ”¯æŒ
- æ¶ˆæ¯æŒä¹…åŒ–

### Phase 2: å¸¦éªŒè¯çš„å•ä»»åŠ¡ Agent ğŸš§ è¿›è¡Œä¸­
- **å·¥å…·ç³»ç»Ÿ**ï¼šAgent å¯è°ƒç”¨å·¥å…·ï¼ˆClaude Codeã€Shellã€æ–‡ä»¶æ“ä½œï¼‰
- **æ‰§è¡Œå¾ªç¯**ï¼šReAct æ¨¡å¼ï¼ˆæ€è€ƒâ†’è¡ŒåŠ¨â†’è§‚å¯Ÿâ†’å¾ªç¯ï¼‰
- **éªŒè¯ç³»ç»Ÿ**ï¼šæ‰§è¡Œåè‡ªåŠ¨æ£€æŸ¥ç»“æœ
- **çŠ¶æ€æ¢å¤**ï¼šä¸­æ–­åèƒ½ç»§ç»­æ‰§è¡Œ

### Phase 3: å¤šé˜¶æ®µæµæ°´çº¿ï¼ˆæœªæ¥ï¼‰
- Pipeline å®šä¹‰å’Œç¼–æ’
- é˜¶æ®µé—´äº§ç‰©ä¼ é€’
- å¤š Agent åä½œ

### Phase 4: å®Œæ•´è½¯ä»¶å·¥ç¨‹æµç¨‹ï¼ˆæœªæ¥ï¼‰
- éœ€æ±‚åˆ†æ Agent
- è®¾è®¡ Agent
- å¼€å‘ Agent
- QA Agent
- éƒ¨ç½² Agent

---

## Phase 2 è¯¦ç»†è®¾è®¡

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Workbench App                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ (Vue)                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ TaskAIChat.vue - ä¼šè¯ç•Œé¢ï¼Œæ˜¾ç¤ºæ‰§è¡Œæ­¥éª¤å’Œæ—¥å¿—        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åç«¯ (Go)                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Agent     â”‚  â”‚  Executor   â”‚  â”‚  Validator  â”‚        â”‚
â”‚  â”‚  (é…ç½®)     â”‚  â”‚  (æ‰§è¡Œå™¨)   â”‚  â”‚  (éªŒè¯å™¨)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â”‚                â”‚                â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                          â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                   Tool Registry                    â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚     â”‚
â”‚  â”‚  â”‚ claude   â”‚ â”‚  shell   â”‚ â”‚  file    â”‚  ...     â”‚     â”‚
â”‚  â”‚  â”‚  code    â”‚ â”‚  exec    â”‚ â”‚  r/w     â”‚          â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åº“ (SQLite)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ agents  â”‚ â”‚ convs   â”‚ â”‚ steps   â”‚ â”‚ tools   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æ¨¡å‹

#### Agent (æ‰§è¡Œå™¨é…ç½®)
```go
type Agent struct {
    ID           int64    `json:"id"`
    Name         string   `json:"name"`         // Agentåç§°
    Type         string   `json:"type"`         // ç±»å‹: planner/executor
    SystemPrompt string   `json:"system_prompt"` // ç³»ç»Ÿæç¤ºè¯
    Tools        []string `json:"tools"`         // å¯ç”¨å·¥å…·åˆ—è¡¨
    Model        string   `json:"model"`         // ä½¿ç”¨çš„æ¨¡å‹
    ProviderID   int64    `json:"provider_id"`   // æ¨¡å‹æä¾›å•†
    MaxRetries   int      `json:"max_retries"`   // æœ€å¤§é‡è¯•æ¬¡æ•°
    Enabled      bool     `json:"enabled"`
}
```

#### Tool (å·¥å…·å®šä¹‰)
```go
type Tool struct {
    Name        string `json:"name"`        // å·¥å…·åç§°
    Description string `json:"description"` // æè¿°ï¼ˆç»™LLMçœ‹ï¼‰
    Type        string `json:"type"`        // cli/api/builtin
    Command     string `json:"command"`     // å‘½ä»¤æ¨¡æ¿
    Validator   string `json:"validator"`   // éªŒè¯å‘½ä»¤
    Schema      string `json:"schema"`      // å‚æ•°JSON Schema
}
```

#### AgentStep (æ‰§è¡Œæ­¥éª¤)
```go
type AgentStep struct {
    ID             int64  `json:"id"`
    ConversationID int64  `json:"conversation_id"`
    StepNum        int    `json:"step_num"`
    Thought        string `json:"thought"`      // AIçš„æ€è€ƒ
    Action         string `json:"action"`       // é€‰æ‹©çš„å·¥å…·
    ActionInput    string `json:"action_input"` // å·¥å…·è¾“å…¥
    Observation    string `json:"observation"`  // æ‰§è¡Œç»“æœ
    Status         string `json:"status"`       // pending/running/success/failed
}
```

### å·¥å…·ç³»ç»Ÿ

#### å†…ç½®å·¥å…·åˆ—è¡¨
| å·¥å…·å | åŠŸèƒ½ | å‚æ•° |
|--------|------|------|
| `claude_code` | è°ƒç”¨ Claude Code CLI æ‰§è¡Œå¤æ‚ä»»åŠ¡ | task, working_dir |
| `shell` | æ‰§è¡Œ shell å‘½ä»¤ | command, working_dir |
| `read_file` | è¯»å–æ–‡ä»¶å†…å®¹ | path |
| `write_file` | å†™å…¥æ–‡ä»¶ | path, content |
| `list_files` | åˆ—å‡ºç›®å½•æ–‡ä»¶ | path, pattern |
| `ask_user` | è¯¢é—®ç”¨æˆ· | question, options |
| `complete` | æ ‡è®°ä»»åŠ¡å®Œæˆ | summary |

#### Tool Calling æ ¼å¼
```json
{
  "thought": "æˆ‘éœ€è¦å…ˆçœ‹çœ‹é¡¹ç›®ç»“æ„",
  "action": "shell",
  "action_input": {
    "command": "ls -la",
    "working_dir": "/path/to/project"
  }
}
```

### æ‰§è¡Œå¾ªç¯ (ReAct)

```
å¼€å§‹æ‰§è¡Œ
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ„å»º Prompt        â”‚
â”‚    - ç³»ç»Ÿæç¤º         â”‚
â”‚    - ä»»åŠ¡æè¿°         â”‚
â”‚    - å¯ç”¨å·¥å…·         â”‚
â”‚    - å†å²æ­¥éª¤         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è°ƒç”¨ LLM           â”‚
â”‚    è·å–ä¸‹ä¸€æ­¥è¡ŒåŠ¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è§£æå“åº”           â”‚
â”‚    - thought          â”‚
â”‚    - action           â”‚
â”‚    - action_input     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      action == "complete"?
            â”‚
      Yes â”€â”€â”´â”€â”€ No
       â”‚        â”‚
       â–¼        â–¼
   [å®Œæˆ]   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 4. æ‰§è¡Œå·¥å…·           â”‚
            â”‚    - è°ƒç”¨å¯¹åº”å·¥å…·      â”‚
            â”‚    - è·å– observation  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 5. éªŒè¯ç»“æœ           â”‚
            â”‚    - æ‰§è¡ŒéªŒè¯å™¨        â”‚
            â”‚    - åˆ¤æ–­æ˜¯å¦æˆåŠŸ      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                  æˆåŠŸ? â”œâ”€â”€ No â”€â”€â–¶ é‡è¯•/è¯¢é—®ç”¨æˆ·
                        â”‚
                        â–¼ Yes
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 6. ä¿å­˜æ­¥éª¤           â”‚
            â”‚    ç»§ç»­ä¸‹ä¸€è½®å¾ªç¯      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â””â”€â”€â–¶ å›åˆ°æ­¥éª¤ 1
```

### éªŒè¯ç³»ç»Ÿ

æ¯ä¸ªå·¥å…·å¯ä»¥é…ç½®éªŒè¯å™¨ï¼š

```yaml
tools:
  - name: shell
    validator:
      type: exit_code  # æ£€æŸ¥é€€å‡ºç 
      expect: 0

  - name: write_file
    validator:
      type: file_exists  # æ£€æŸ¥æ–‡ä»¶å­˜åœ¨

  - name: claude_code
    validator:
      type: custom  # è‡ªå®šä¹‰éªŒè¯
      command: "npm run build && npm test"
```

---

## å½“å‰è¿›åº¦

### å·²å®Œæˆ
- [x] åŸºç¡€æ•°æ®æ¨¡å‹ (model.go)
- [x] æ•°æ®åº“è¡¨ç»“æ„ (database.go)
- [x] ä¼šè¯ç®¡ç† API (conversation.go)
- [x] å‰ç«¯ä¼šè¯ç»„ä»¶ (TaskAIChat.vue)
- [x] ä»»åŠ¡ç®¡ç†é›†æˆ AI æŒ‰é’®
- [x] Agent æ¨¡å‹æ”¯æŒå·¥å…·é…ç½® (type, tools, working_dir, max_retries)
- [x] AgentStep æ¨¡å‹è·Ÿè¸ªæ‰§è¡Œæ­¥éª¤
- [x] å·¥å…·æ³¨å†Œè¡¨ (tools.go - ToolRegistry, ToolExecutor)
- [x] ReAct æ‰§è¡Œå¾ªç¯ (ai_executor.go - ReActExecutor)
- [x] å†…ç½®å·¥å…·å®ç° (shell, read_file, write_file, list_files, ask_user, complete)
- [x] Claude Code CLI é›†æˆ (claude_code å·¥å…·)
- [x] å‰ç«¯æ‰§è¡Œæ­¥éª¤æ—¶é—´çº¿æ˜¾ç¤º

### å¾…å®Œæˆ (Phase 2 ä¼˜åŒ–)
- [ ] éªŒè¯ç³»ç»Ÿ (validator.go)
- [ ] å·¥å…·æ‰§è¡Œè¶…æ—¶æ§åˆ¶
- [ ] é”™è¯¯é‡è¯•æœºåˆ¶
- [ ] å‰ç«¯ Agent é…ç½®ç•Œé¢å®Œå–„ï¼ˆå·¥å…·é€‰æ‹©ã€å·¥ä½œç›®å½•è®¾ç½®ï¼‰

---

## æ–‡ä»¶ç»“æ„

```
Workbench/
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ AI_AGENT_DESIGN.md     # æœ¬æ–‡æ¡£
â”œâ”€â”€ model.go                    # æ•°æ®æ¨¡å‹ (Agent, AgentStep, AgentTool, å¸¸é‡ç­‰)
â”œâ”€â”€ database.go                 # æ•°æ®åº“æ“ä½œ (agents, agent_steps è¡¨)
â”œâ”€â”€ agent.go                    # Agent CRUD æ“ä½œ
â”œâ”€â”€ conversation.go             # ä¼šè¯ç®¡ç†
â”œâ”€â”€ ai_executor.go              # ReAct æ‰§è¡Œå™¨ (ReActExecutor)
â”œâ”€â”€ tools.go                    # å·¥å…·ç³»ç»Ÿ (ToolRegistry, ToolExecutor, å†…ç½®å·¥å…·)
â”œâ”€â”€ validator.go                # éªŒè¯ç³»ç»Ÿ (å¾…åˆ›å»º)
â””â”€â”€ frontend/src/components/
    â”œâ”€â”€ TaskAIChat.vue          # ä¼šè¯å‰ç«¯ç»„ä»¶ (å«æ‰§è¡Œæ­¥éª¤æ—¶é—´çº¿)
    â”œâ”€â”€ TaskManagement.vue      # ä»»åŠ¡ç®¡ç† (AI æŒ‰é’®å…¥å£)
    â”œâ”€â”€ Workbench.vue           # å·¥ä½œå° (AI æŒ‰é’®å…¥å£)
    â””â”€â”€ Settings.vue            # è®¾ç½®é¡µé¢ (Agent ç®¡ç†)
```

---

## åç»­è®¡åˆ’

1. **æœ¬æ¬¡ç›®æ ‡**ï¼šå®Œæˆ Phase 2 çš„å·¥å…·ç³»ç»Ÿå’Œæ‰§è¡Œå¾ªç¯
2. **ä¸‹æ¬¡ç›®æ ‡**ï¼šæ·»åŠ éªŒè¯ç³»ç»Ÿï¼Œå®Œå–„é”™è¯¯å¤„ç†
3. **å†ä¸‹æ¬¡**ï¼šå‰ç«¯ä¼˜åŒ–ï¼Œæ˜¾ç¤ºæ‰§è¡Œæ­¥éª¤æ—¶é—´çº¿
4. **æœ€ç»ˆ**ï¼šå‡†å¤‡å¥½è¿›åŒ–åˆ° Phase 3 çš„åŸºç¡€

---

## å‚è€ƒèµ„æ–™

- [ReAct: Synergizing Reasoning and Acting](https://arxiv.org/abs/2210.03629)
- [LangChain Agents](https://python.langchain.com/docs/modules/agents/)
- [Claude Tool Use](https://docs.anthropic.com/claude/docs/tool-use)
- [OpenDevin](https://github.com/OpenDevin/OpenDevin)
